window.videaShared=angular.module("videaShared",["videaUtil"]),window.videaShared.controller("AuthenticationManagerController",["$scope","$http","$timeout","authenticationManagerService",function(e,n,r,t){function o(){e.showTimeoutModal()}function i(){n.post("/Account/LogOff").success(function(){var e=window.location.pathname+window.location.search+window.location.hash;e.length>0&&(e="?ReturnUrl="+encodeURIComponent(e)),window.location="/Account/Login"+e})}function a(){var e=new Date,n=u.setMinutes(u.getMinutes()+parseInt(l));return Date.parse(e)>n}e.modalShown=!1,e.authWarning=0,e.showTimeoutModal=function(){e.modalShown=!0},e.hideTimeoutModal=function(){e.modalShown=!1};var l,s,d,c,u=new Date;e.resetTimeout=function(){null!=c&&r.cancel(c),null!=d&&r.cancel(d),u=new Date,d=r(o,60*s*1e3),c=r(i,60*parseInt(l)*1e3),e.hideTimeoutModal()},e.refreshTimeout=function(){a()?i():n.post("/Account/RefreshAuthenticatonTimeout").success(function(){e.resetTimeout()})},t.setTimeout(e.refreshTimeout),e.showAuthWarning=o,e.redirectToLoginPage=i,e.init=function(n){l=n.authTimeout,e.authWarning=n.authWarning,s=parseInt(l)-parseInt(e.authWarning),d=r(e.showAuthWarning,60*s*1e3),c=r(e.redirectToLoginPage,60*parseInt(l)*1e3)}}]),window.videaShared.controller("AutoCompleteController",["$scope","$rootScope",function(e,n){n.suggestions=[],n.selectedIndex=-1,n.search=function(){n.suggestions=[];for(var r=0,t=0;t<e.searchList.length;t++){var o=angular.lowercase(e.searchList[t]),i=angular.lowercase(e.ssSearch);if(-1!==o.indexOf(i)&&(n.suggestions.push(o),r+=1,5==r))break}},n.checkKeyDown=function(e){40===e.keyCode?(e.preventDefault(),n.selectedIndex+1!==n.suggestions.length&&n.selectedIndex++):38===e.keyCode?(e.preventDefault(),n.selectedIndex-1!==-1&&n.selectedIndex--):13===e.keyCode&&(e.preventDefault(),n.suggestions=[])},n.checkKeyUp=function(r){(8!==r.keyCode||46!==r.keyCode)&&""==e.ssSearch&&(n.suggestions=[])},n.assignValue=function(r){e.ssSearch=n.suggestions[r],n.suggestions=[]}}]),window.videaShared.controller("ForgotPasswordController",["$scope",function(e){e.loadedModel=null,e.init=function(){e.loadedModel=PreloadStore.get("model")}}]),window.videaShared.controller("GeneralPreferencesController",["$scope","$window","generalPreferencesService",function(e,n,r){e.profile={currentPassword:"",newPassword:"",confirmPassword:"",currentPhoneNumber:"",newPhoneNumber:"",confirmPhoneNumber:""};var t=function(e,n){angular.forEach(e,function(e,r){r in n&&(n[r]=e)})};e.loadedModel=null,e.init=function(){e.loadedModel=PreloadStore.get("model"),t(e.loadedModel,e.profile)},e.clearForm=function(){t(e.loadedModel,e.profile),e.loadedModel.modelState=null},e.dirtyModalShown=!1,e.toggleDirtyModal=function(){e.dirtyModalShown=!e.dirtyModalShown},e.init(),e.saveUserProfile=function(){e.userSettingsForm.$valid&&r.saveProfile(e.profile).then(function(n){e.loadedModel.modelState=n.data},function(e){alert("Error: "+e)})}}]),window.videaShared.controller("LoadingController",["$scope","requestNotificationChannel",function(e,n){e.notificationMessaging=n,e.modalShown=!1,e.$watch("notificationMessaging",function(){e.notificationMessaging.requestsInFlight>0?e.modalShown=!0:e.notificationMessaging.requestsInFlight<1&&(e.modalShown=!1)},!0)}]),window.videaShared.controller("SendCodeController",["$scope",function(e){e.$watch("selectedProvider",function(n,r){n!=r&&(e.address=e.addresses[n])}),e.init=function(n){e.addresses=n}}]),window.videaShared.controller("UpdatePasswordController",["$scope",function(e){e.Password="",e.ConfirmPassword="",e.Email="",e.init=function(n){e.Email=n,e.loadedModel=PreloadStore.get("model")},e.submit=function(e,n){}}]),window.videaShared.directive("autoComplete",["$rootScope",function(e){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"/Scripts/app/shared/templates/autoComplete.html",rootScope:{serachList:"="},require:"ngModel",controller:"AutoCompleteController",link:function(n,r,t,o){e.$watch("selectedIndex",function(e){-1!==e&&"undefined"!=r.suggestions&&(n.ssSearch=r.suggestions[r.selectedIndex])})}}}]),window.videaShared.directive("defaultRoute",function(){return{restrict:"A",scope:{defaultRoute:"@"},controller:["$scope","$location",function(e,n){e.checkDefaultRoute=function(){""==n.path()&&n.path(e.defaultRoute)}}],link:function(e,n,r){e.checkDefaultRoute(r)}}}),window.videaShared.directive("errorlist",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"/Scripts/app/shared/templates/errorList.html",scope:{modelstate:"=",field:"@field"},controller:["$scope",function(e){}]}}),window.videaShared.directive("modalDialog",function(){return{restrict:"E",scope:{show:"="},replace:!0,transclude:!0,link:function(e,n,r){e.dialogStyle={},r.width&&(e.dialogStyle.width=r.width),r.height&&(e.dialogStyle.height=r.height),e.showModal=function(){e.show=!0},e.hideModal=function(){e.show=!1}},templateUrl:"/Scripts/app/shared/templates/modal-dialog.html"}}),window.videaShared.directive("passwordPolicy",["$http",function(e){var n=6,r=50,t=2,o=[/\d/,/[a-zA-Z]/,/[\!\@\#\$\%\^\&\*\(\)\_\+]/],i=function(e,i){if(0==window.videaShared.enablePasswordPolicy)return!0;if(i.length<n)return!1;if(i.length>r)return!1;var a=0;if(t>0){for(var l=0,s=o.length;s>l;l++)a+=o[l].test(i)?1:0;if(t>a)return!1}return-1!=i.indexOf(e)?!1:!0};return{require:"ngModel",link:function(e,n,r,t){e.$watch(r.ngModel,function(n,o){if(n!=o){var a=e.$eval(r.passwordPolicy).split("@")[0];t.$setValidity("passwordPolicy",i(a,n))}})}}}]),window.videaShared.directive("scrollToTop",function(){return{restrict:"A",link:function(e,n){n.css("cursor","pointer"),n.on("click",function(){$("body").animate({scrollTop:0},"fast")})}}}),window.videaShared.directive("userSettings",function(){return{restrict:"E",transclude:!0,templateUrl:"/Scripts/app/shared/templates/user-settings.html",replace:!0,controller:"GeneralPreferencesController"}}),window.videaShared.directive("vuiCheckbox",[function(){return{restrict:"E",replace:!0,scope:{value:"=",cbdisabled:"=",text:"@"},link:function(e,n){var r=!1,t=n.find(":checkbox");t.length>0&&(t.checkbox(e.value?"check":"uncheck"),t.on("change",function(){r=!0,e.value!==t[0].checked&&e.$apply(function(){e.value=t[0].checked}),r=!1}));var o=e.$watch("cbdisabled",function(e){t[0].disabled=e,t.checkbox({})}),i=e.$watch("value",function(e,n){e!==n&&(r||t.checkbox(e?"check":"uncheck"))},!0);e.$on("$destroy",function(){o(),i(),t.off("change")})},template:'<div class="checkbox vui-checkbox"><input type="checkbox" ng-disabled="cbdisabled" ng-model="value" /><label ng-bind="text" ng-disabled="cbdisabled"></label></div>'}}]),window.videaShared.directive("vuiDropdown",[function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"/Scripts/app/shared/templates/vui-dropdown.html",scope:{config:"=",selectedItem:"="},controller:["$scope",function(e){e.isOpen=!1,e.itemSelected=function(n){e.isOpen=!1,e.config.selectedItem=n},e.styleBaseWidth=e.config.width,e.styleDropDownHeight=e.config.height,e.styleInnerWidth=e.config.width-16,e.styleDisplayDivWidth=e.config.width-10,e.styleDownIconLeftMargin=0,e.styleDropDownWidth=e.config.width,e.styleTriangleUpLeft=e.config.width-25}]}}]),window.videaShared.directive("vuiMatch",function(){return{require:"ngModel",restrict:"A",scope:{vuiMatch:"="},link:function(e,n,r,t){e.$watch(function(){var n=t.$modelValue||t.$$invalidModelValue;return t.$pristine&&angular.isUndefined(n)||e.vuiMatch===n},function(e){t.$setValidity("match",e)})}}}),window.videaShared.directive("vuiPager",[function(){return{restrict:"EA",templateUrl:"/Scripts/app/shared/templates/vui-pager.html",replace:!0,transclude:!1,controller:["$scope","$element","$attrs",function(e,n,r){e._changeFunction=r.changeFunction,e._maxSize=e.$eval(r.maxSize),e.changeFunction=function(){e[r.changeFunction](e.currentPage)}}]}}]),window.videaShared.factory("generalPreferencesService",["$http",function(e){var n=function(n){var r=n;return e.post("/UserPreferences/General/SaveProfile",r)};return{saveProfile:n}}]),window.videaShared.service("gridSortUtilityService",[function(){function e(e,n){return function(t,o){var i=new Date(t[e]),a=new Date(o[e]);return r(i,a,n)}}function n(e,n){return function(t,o){var i=new Date(t[e]),a=new Date(o[e]),l=new Date(1981,2,26,i.getUTCHours(),i.getUTCMinutes()),s=new Date(1981,2,26,a.getUTCHours(),a.getUTCMinutes());return r(l,s,n)}}function r(e,n,r){return r?e>n?-1:n>e?1:0:n>e?-1:e>n?1:0}return{dateSort:e,timeSort:n}}]),window.videaShared.factory("preferencesService",["$http",function(e){var n=function(){return e.get("/Sellers/Preferences/GetPreferences")},r=function(){return e.get("/Sellers/Preferences/GetPreferencesWithSearchList")};return{getPreferences:n,getPreferencesWithSearchList:r}}]),function(e){window.videaShared.factory("SignalrHub",["$log","$q",function(n,r){function t(t,i){i=i||{},o=o||e.hubConnection();var a,l=o.createHubProxy(t);i.listeners&&angular.forEach(i.listeners,function(e,n){l.on(n,e)}),i.errorHandler&&o.error(i.errorHandler),this.invoke=function(){var e=Array.prototype.slice.call(arguments,0),n=r.defer();return l.promise.done(function(){l.invoke.apply(l,e).done(function(){var e=Array.prototype.slice.call(arguments,0);n.resolve.apply(n,e)}).fail(function(){var e=Array.prototype.slice.call(arguments,0);n.reject.apply(n,e)})}),n.promise},this.off=function(e,n){l.off(e,n)},l.promise=o.start().done(function(){a=!0}).fail(function(e){n.error(e)})}var o;return t}])}(jQuery),angular.module("videaShared").run(["$templateCache",function(e){e.put("/Scripts/app/shared/templates/autoComplete.html",'<div class="col-md-4">\r\n    <input name="ssSearch" placeholder="Search" search-list="searchList" ng-keydown="checkKeyDown($event)" ng-keyup="checkKeyUp($event)" ng-model="ssSearch" ng-change="search()" type="text" style="font-size:16px;width: 5.5em;width:100%;height:3em;padding:.5em;margin: 0 .5em 0 0;" />\r\n\r\n    <ul class="autocomplete-list">\r\n        <li ng-repeat="suggestion in suggestions track by $index" ng-click="assignValue($index)">{{suggestion}}</li>\r\n    </ul>\r\n</div>'),e.put("/Scripts/app/shared/templates/errorList.html",'<div class="buyer-field-validation" data-ng-show="modelstate != null && modelstate[field] != null && modelstate[field].errors.length > 0">\r\n    <div data-ng-repeat="error in modelstate[field].errors" style="position:relative;top:-10px;">\r\n        <div style="float:left;padding-left:10px;padding-top:5px;"><i class="glyphicon glyphicon-warning-sign"></i></div>\r\n        <div style="padding-left:30px;padding-top:5px;">{{error.errorMessage}}</div>\r\n    </div>\r\n</div>\r\n'),e.put("/Scripts/app/shared/templates/modal-dialog.html","<div class='ng-modal' ng-show='show'>\r\n    <div class='ng-modal-overlay' ng-click='showModal()'></div>\r\n    <div class='ng-modal-dialog' ng-style='dialogStyle'>\r\n        <div class='ng-modal-close' ng-click='hideModal()'><i class=\"icon-times-circle\"><div class=\"icon-bg\"></div></i></div>\r\n        <div class='ng-modal-dialog-content' ng-transclude></div>\r\n    </div>\r\n</div>"),e.put("/Scripts/app/shared/templates/user-settings.html",'<div class="preferences">\r\n    <div ng-form="userSettingsForm">\r\n        <div>\r\n            <div class="row">\r\n                <div class="col-md-12">\r\n                    <h2>Reset Password</h2>\r\n                </div>\r\n            </div>\r\n            <div class="row">\r\n                <div class="col-lg-4">\r\n                    <p>Please enter your old password and confirm your new password.</p>\r\n                </div>\r\n            </div>\r\n            <div class="row" style="margin-bottom: 40px;">\r\n                <div class="col-lg-4" style="border-right: solid 2px #E8EBED;">\r\n\r\n                    <div class="form-group" style="width: 232px;">\r\n                        <span>Old Password:</span>\r\n                        <input class="preference-box form-control" data-ng-model="profile.currentPassword" name="currentPassword" type="password" />\r\n                        <data-errorlist modelstate="loadedModel.modelState" field="currentPassword"></data-errorlist>\r\n                    </div>\r\n\r\n                    <div class="form-group" style="width: 232px;">\r\n                        <span>New Password:</span>\r\n                        <input class="preference-box form-control" data-ng-model="profile.newPassword" name="newPassword" type="password" />\r\n                        <data-errorlist modelstate="loadedModel.modelState" field="newPassword"></data-errorlist>\r\n                    </div>\r\n                    <div class="form-group" style="width: 232px;">\r\n                        <span>Confirm New Password:</span>\r\n                        <input class="preference-box form-control" data-ng-model="profile.confirmPassword" name="confirmPassword" data-vui-match="profile.newPassword" type="password" />\r\n                        <data-errorlist modelstate="loadedModel.modelState" field="confirmPassword"></data-errorlist>\r\n                    </div>\r\n                </div>\r\n                <div class="col-lg-6" style="margin-left:40px">\r\n                    <div class="form-group">\r\n                        <h4>Password Requirements</h4>\r\n                        <p>At least 6 characters</p>\r\n                        <p>Contains uppercase and lowercase letters</p>\r\n                        <p>Contains a number</p>\r\n                        <p>Contains at least 1 special character</p>\r\n                        <p>Does NOT include your email or username</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            \r\n\r\n            <div style="border-bottom: solid 2px #E8EBED; margin-bottom: 40px;"></div>\r\n            \r\n\r\n            <div class="row">\r\n                <div class="col-md-12">\r\n                    <h2>Contact Information</h2>\r\n                </div>\r\n            </div>\r\n            <div class="row">\r\n                <div class="col-lg-4">\r\n                    <h4>Update Phone Number</h4>\r\n                    <p>Please enter your phone number and confirm your new phone number.</p>\r\n                </div>\r\n                <div class="col-lg-6" style="margin-left:40px;">\r\n                    <p style="margin-top:38px;">Please contact the administrator at 844-213-8543 or admin@videa.tv if you need to have your email updated.</p>\r\n                </div>\r\n            </div>\r\n            <div class="row" style="margin-bottom: 20px;">\r\n                <div class="col-lg-4">\r\n                    <div class="form-group" style="width: 232px;">\r\n                        <span>Phone Number:</span>\r\n                        <input class="preference-box form-control" data-ng-model="profile.currentPhoneNumber" ui-mask="{{\'999 - 999 - 9999\'}}" type="text" disabled />\r\n                    </div>\r\n                    <div class="form-group" style="width: 232px;">\r\n                        <span>New Phone Number (xxx-xxx-xxxx):</span>\r\n                        <input class="preference-box form-control" value="{{profile.newPhoneNumber}}" data-ng-model="profile.newPhoneNumber" name="newPhoneNumber" ui-mask="{{\'999 - 999 - 9999\'}}" type="text" />\r\n                        <data-errorlist modelstate="loadedModel.modelState" field="newPhoneNumber"></data-errorlist>\r\n                    </div>\r\n                    <div class="form-group" style="width: 232px;">\r\n                        <span>Confirm New Phone Number:</span>\r\n                        <input class="preference-box form-control" value="{{profile.confirmPhoneNumber}}" data-ng-model="profile.confirmPhoneNumber" name="confirmPhoneNumber" vui-match="profile.newPhoneNumber" ui-mask="{{\'999 - 999 - 9999\'}}" type="text" />\r\n                        <data-errorlist modelstate="loadedModel.modelState" field="confirmPhoneNumber"></data-errorlist>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        </div>\r\n        <div class="row">\r\n            <div class="col-md-12">\r\n                <input type="button" class="btn btn-primary pref-button" value="SUBMIT" ng-click="saveUserProfile()" />\r\n                <input type="button" class="btn btn-primary pref-button pref-cancel" value="CANCEL" ng-click="toggleDirtyModal()" />\r\n            </div>\r\n        </div>\r\n\r\n        <data-modal-dialog show=\'dirtyModalShown\' width=\'400px\' height=\'170px\'>\r\n            <div class="modal-title"> <h2> Warning </h2> </div>\r\n            <div class="modal-table">\r\n                <p>You have unsaved changes. Close and lose changes?</p>\r\n            </div>\r\n            <div>\r\n                <input type="button" ng-click="clearForm();toggleDirtyModal();" class="btn btn-primary" value="OK" />\r\n                <input type="button" ng-click="toggleDirtyModal()" class="btn btn-primary" value="Cancel" />\r\n            </div>\r\n        </data-modal-dialog>\r\n    </div>\r\n</div>'),e.put("/Scripts/app/shared/templates/vui-dropdown.html",'<div class="videa-dropdown" ng-style="{ \'width\' : styleBaseWidth}">\r\n    <div class="dropdown" is-open="isOpen" ng-style="{ \'width\' : styleInnerWidth}">\r\n        <a class="dropdown-toggle" aria-haspopup="true" aria-expanded="false">\r\n            <div ng-style="{ \'width\' : styleDisplayDivWidth}">\r\n                <span>{{config.selectedItem !== null ? config.selectedItem[config.dataItemName] : config.displayName}}</span>\r\n                <i class="icon-angle-down" ng-style="{ \'margin-left\' : styleDownIconLeftMargin}"></i>\r\n            </div>\r\n        </a>\r\n        <ul class="dropdown-menu" role="menu" ng-style="{\'height\' : styleDropDownHeight, \'width\' : styleDropDownWidth}">\r\n            <li data-ng-click="itemSelected(item)" data-ng-repeat="item in config.dataSource | orderBy: config.orderBy">\r\n                <a>\r\n                    <i class="icon-triangle-up" ng-style="{ \'left\' : styleTriangleUpLeft}"></i>\r\n                    {{item[config.dataItemName]}}\r\n                </a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>'),e.put("/Scripts/app/shared/templates/vui-pager.html",'<div class="vui-pagination">\r\n    <span>{{numPages}} pages</span>\r\n    <div>\r\n        <pagination total-items="totalItems" items-per-page="itemsPerPage" ng-model="currentPage" ng-change="changeFunction()" max-size="_maxSize" previous-text="&#xe072;" next-text="&#xe072;" boundary-links="false" rotate="false" num-pages="numPages"></pagination>\r\n    </div>\r\n</div>')}]);